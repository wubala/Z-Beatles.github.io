---
layout: post
title: vxlan
category: Network
tags: [Network]
---
vxlan 学习&练习，控制器

## 典型组网

### 场景一：

![vxlan1](/picture/vxlan1.png)

#### 配置参考

```
  ip link add tap1 type veth peer name vtap1
  ip link add tap2 type veth peer name vtap2
  ip netns add ns1
  ip netns add ns2
  ip link set vtap1 netns ns1
  ip link set vtap2 netns ns2
  ip netns exec ns1 ifconfig lo up
  ip netns exec ns1 ifconfig vtap1 up
  ip netns exec ns1 ifconfig vtap1 1.1.1.2/24
  ip netns exec ns2 ifconfig lo up
  ip netns exec ns2 ifconfig vtap2 up
  ip netns exec ns2 ifconfig vtap2 1.1.1.3/24
  ovs-vsctl add-br br0
  ifconfig tap1 up
  ifconfig tap2 up
  ovs-vsctl add-port br0 tap1
  ovs-vsctl add-port br0 tap2
  ovs-vsctl add-port br0 tap2 tag=3
  ovs-vsctl add-port br0 vx1 -- set interface vx1 type=vxlan options:remote_ip=192.168.2.100
```
![vxlan_ovs](/picture/vxlan_ovs.png)

### 场景二：二层通讯，同vxlan的vni，报文vlan相同

![sameVNIVLAN](/picture/host2-eth-same-vni-same-vlan.png)

#### 配置

host1:
![host1](/picture/host1-1.1.png)

host2:
![host2](/picture/host2-1.1.png)

## 引用
* [vxlan基础理解](http://blog.csdn.net/freezgw1985/article/details/16354897)
* [vxlan整理学习](http://blog.csdn.net/freezgw1985/article/details/16354897)
* [关于VXLAN与异构云之间的集成](http://www.aboutyun.com/forum.php?mod=viewthread&tid=8721&highlight=vxlan)
* [ovs配置vxlan的vni](http://openvswitch.org/pipermail/dev/2013-February/025591.html)


